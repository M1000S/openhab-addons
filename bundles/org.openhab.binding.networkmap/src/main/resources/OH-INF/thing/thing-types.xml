<?xml version="1.0" encoding="UTF-8"?>
<thing:thing-descriptions bindingId="networkmap"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:thing="https://openhab.org/schemas/thing-description/v1.0.0"
	xsi:schemaLocation="https://openhab.org/schemas/thing-description/v1.0.0 https://openhab.org/schemas/thing-description-1.0.0.xsd">

	<!-- Subnet Thing Type -->
	<thing-type id="subnetscan">
		<!-- Comment this in for Things which need a Bridge to function.
			<supported-bridge-type-refs>
			<bridge-type-ref id="networkmapBridge" />
			</supported-bridge-type-refs>
		-->

		<label>Subnet Scan</label>
		<description>Subnet scan for alive hosts and optionally for open ports.</description>

		<channels>
			<channel id="NumberOfHosts" typeId="hostnumber-channel"/>
            <channel id="NamesOfHosts" typeId="hostname-channel"/>
            <channel id="AddressesOfHosts" typeId="hostaddr-channel"/>
            <channel id="PortsOfHosts" typeId="hostports-channel"/>            
            <channel id="StateOfHosts" typeId="hoststate-channel"/>
            <channel id="LastSeenHosts" typeId="hostseen-channel"/>
            <channel id="LastUpdateHosts" typeId="hostupdate-channel"/>
		</channels>


		<config-description>
            <parameter name="nmap" type="text" required="true">
                <context>Nmap</context>
                <label>nmap bin location</label>
                <default>/bin/nmap</default>
                <description>Path to nmap binary must be provided, e.g. /bin/nmap</description>
            </parameter>		
			<parameter name="subnet" type="text" required="true">
				<context>network-address</context>
				<label>Subnet</label>
				<default>192.168.201.0/24</default>
				<description>Subnet which shall be scanned e.g. 192.168.192.0/24 or 192.168.192.1-100</description>
			</parameter>
			<parameter name="ports" type="boolean" required="true">
				<context>Ports</context>
				<label>Scan Ports</label>
				<default>true</default>
				<description>Switch to activate scan for open ports.</description>
			</parameter>
			<parameter name="domain" type="boolean" required="true">
                <context>Domain</context>
                <label>Strip Local Domains</label>
                <default>true</default>
                <description>Switch to strip local domains from host names.</description>
            </parameter>
            <parameter name="refreshInterval" type="integer" unit="m" min="5" required="true">
                <label>Refresh Interval</label>
                <default>10</default>
                <description>Interval the subnet is scanned in minutes. Depending on number of hosts in the subnet, interval has to be increased. </description>
            </parameter>
            <parameter name="overwrite" type="boolean" required="true">
                <context>Overwrite</context>
                <label>Use alias host names</label>
                <default>false</default>
                <description>Switch to overwrite host names with alias names.</description>
            </parameter>			
            <parameter name="alias" type="text" required="false" multiple="true">
                <context>Aliases</context>
                <label>Alias host names</label>
                <multipleLimit>5</multipleLimit>
                <description>overwrite host names by ipv4 address. One per line. Format ipv4:alias".</description>
            </parameter>			

		</config-description>
	</thing-type>

	<!-- Sample Channel Type -->
	<channel-type id="hostnumber-channel">
		<item-type>Number</item-type>
		<label>Hosts</label><!-- Use uppercase words, except prepositions. 2-3 words, max 25 chars -->
		<description>Number of alive hosts found in subnet scan</description>
	</channel-type>
    <channel-type id="hostname-channel">
        <item-type>String</item-type>
        <label>Host Names</label><!-- Use uppercase words, except prepositions. 2-3 words, max 25 chars -->
        <description>Comma seperated list of names of hosts found in the subnet (undef for hosts without name)</description>
    </channel-type>	
    <channel-type id="hostaddr-channel">
        <item-type>String</item-type>
        <label>Host Addresses</label><!-- Use uppercase words, except prepositions. 2-3 words, max 25 chars -->
        <description>Comma seperated list of IPv4 addresses of the hosts found in the subnet</description>
    </channel-type>     
    <channel-type id="hostports-channel">
        <item-type>String</item-type>
        <label>Host Ports</label><!-- Use uppercase words, except prepositions. 2-3 words, max 25 chars -->
        <description>Semicolon seperated list of comma separated lists of open ports of the hosts found in the subnet (undef for hosts without name)</description>
    </channel-type>
    <channel-type id="hoststate-channel">
        <item-type>String</item-type>
        <label>Host States</label><!-- Use uppercase words, except prepositions. 2-3 words, max 25 chars -->
        <description>Semicolon seperated list with state of the hosts found in the subnet</description>
    </channel-type>       
    <channel-type id="hostseen-channel">
        <item-type>String</item-type>
        <label>Last seen active host</label><!-- Use uppercase words, except prepositions. 2-3 words, max 25 chars -->
        <description>Semicolon seperated list with last activity of the hosts found in the subnet</description>
    </channel-type>    
    <channel-type id="hostupdate-channel">
        <item-type>String</item-type>
        <label>Last update of state</label><!-- Use uppercase words, except prepositions. 2-3 words, max 25 chars -->
        <description>Semicolon seperated list with last uodate of state of the hosts found in the subnet</description>
    </channel-type>                   
</thing:thing-descriptions>
